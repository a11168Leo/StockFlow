import{g,s as p}from"./auth-DdmjKQKl.js";const w="http://localhost:8000",i="mixed".toLowerCase(),c="shopping-cart-01-svgrepo-com.svg,shopping-cart-round-1137-svgrepo-com.svg,delivery-truck.svg,inventory-box.svg,warehouse.svg,barcode.svg,business-bag-that-can-be-used-for-svgrepo-com.svg,business-suitcase-svgrepo-com.svg".split(",").map(t=>t.trim()).filter(Boolean),m=document.getElementById("login-form"),h=document.getElementById("message"),s=document.getElementById("submit-btn"),r=document.getElementById("starfield");function M(){if(!r)return;const t=Math.min(120,Math.floor(window.innerWidth/11));for(let n=0;n<t;n+=1){const e=document.createElement("span"),o=Math.random()>.62;e.className=`star ${o?"near":"far"}`;const a=o?Math.random()*1.9+.8:Math.random()*1.4+.4;e.style.width=`${a}px`,e.style.height=`${a}px`,e.style.left=`${Math.random()*100}%`,e.style.top=`${Math.random()*100}%`,e.style.setProperty("--twinkle-duration",`${2.6+Math.random()*5.2}s`),e.style.animationDelay=`${Math.random()*4}s`,r.appendChild(e)}}function v(){if(!r||c.length===0)return;const t=document.createElement("img");t.className="rain-icon";const n=c[Math.floor(Math.random()*c.length)],e=Math.random()*24+16;t.src=`/icons/${n}`,t.alt="",t.loading="lazy",t.style.left=`${Math.random()*100}%`,t.style.top=`${-50-Math.random()*80}px`,t.style.width=`${e}px`,t.style.height=`${e}px`,t.style.opacity=`${.34+Math.random()*.36}`,t.style.setProperty("--icon-duration",`${6.5+Math.random()*6.5}s`),t.style.setProperty("--icon-drift",`${-55+Math.random()*110}px`),t.style.setProperty("--icon-rotate",`${80+Math.random()*170}deg`),t.style.animationDelay=`${Math.random()*.5}s`,t.onerror=()=>t.remove(),r.appendChild(t),window.setTimeout(()=>t.remove(),12e3)}function $(t,n,e){const o=()=>{t();const a=n+Math.random()*(e-n);window.setTimeout(o,a)};o()}function E(){M(),(i==="icons"||i==="mixed"||i==="stars")&&$(v,700,1700)}function f(t){return t==="admin"?"/admin/":t==="lider"||t==="gerente"?"/gerente/":t==="funcionario"?"/funcionario/":null}function l(t,n=""){h.textContent=t,h.className=`message ${n}`.trim()}async function x(t,n){const e=await fetch(`${w}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,senha:n})}),o=await e.json().catch(()=>({}));if(!e.ok)throw new Error(o.detail||"Falha ao autenticar.");return o}const b=g(),u=f(b);u&&window.location.replace(u);E();m.addEventListener("submit",async t=>{t.preventDefault();const n=new FormData(m),e=String(n.get("email")||"").trim(),o=String(n.get("senha")||"").trim();l(""),s.disabled=!0,s.textContent="Entrando...";try{const a=await x(e,o);p(a.access_token,a.refresh_token);const y=g(),d=f(y);if(!d)throw new Error("Perfil sem area configurada no frontend.");l("Login realizado com sucesso.","success"),window.location.replace(d)}catch(a){l(a.message,"error")}finally{s.disabled=!1,s.textContent="Entrar"}});
