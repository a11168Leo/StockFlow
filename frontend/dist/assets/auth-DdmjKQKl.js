(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))l(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&l(c)}).observe(document,{childList:!0,subtree:!0});function n(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(e){if(e.ep)return;e.ep=!0;const r=n(e);fetch(e.href,r)}})();const s="stockflow_access_token",i="stockflow_refresh_token";function f(o){const t=o.replace(/-/g,"+").replace(/_/g,"/"),n=t+"=".repeat((4-t.length%4)%4);return atob(n)}function a(o){if(!o||typeof o!="string")return null;const t=o.split(".");if(t.length!==3)return null;try{const n=f(t[1]);return JSON.parse(n)}catch{return null}}function u(){return localStorage.getItem(s)}function p(o,t){localStorage.setItem(s,o),localStorage.setItem(i,t)}function d(){localStorage.removeItem(s),localStorage.removeItem(i)}function g(){return a(u())?.perfil||null}function m(o){const t=u(),n=a(t);if(!t||!n?.perfil)return window.location.replace("/login/"),null;const l=n.perfil;return o.includes(l)?{role:l,userId:n.sub}:(window.location.replace("/login/"),null)}function y(){d(),window.location.replace("/login/")}export{m as e,g,y as l,p as s};
