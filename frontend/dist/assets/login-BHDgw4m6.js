import{g as v,a as x,s as C}from"./auth-C0PzaMq8.js";const b="http://localhost:8000",l="mixed".toLowerCase(),m="shopping-cart-01-svgrepo-com.svg,shopping-cart-round-1137-svgrepo-com.svg,delivery-truck.svg,inventory-box.svg,warehouse.svg,barcode.svg,business-bag-that-can-be-used-for-svgrepo-com.svg,business-suitcase-svgrepo-com.svg".split(",").map(t=>t.trim()).filter(Boolean),h=document.getElementById("login-form"),y=document.getElementById("message"),i=document.getElementById("submit-btn"),k=document.getElementById("remember-me"),S=document.getElementById("forgot-password-btn"),M=document.getElementById("forgot-password-dialog"),P=document.getElementById("forgot-password-form"),B=document.getElementById("forgot-email"),p=document.getElementById("forgot-message"),c=document.getElementById("forgot-submit-btn"),L=document.getElementById("forgot-close-btn"),w=document.getElementById("senha"),g=document.getElementById("toggle-password"),d=document.getElementById("starfield");function N(){if(!d)return;const t=Math.min(120,Math.floor(window.innerWidth/11));for(let o=0;o<t;o+=1){const e=document.createElement("span"),n=Math.random()>.62;e.className=`star ${n?"near":"far"}`;const s=n?Math.random()*1.9+.8:Math.random()*1.4+.4;e.style.width=`${s}px`,e.style.height=`${s}px`,e.style.left=`${Math.random()*100}%`,e.style.top=`${Math.random()*100}%`,e.style.setProperty("--twinkle-duration",`${2.6+Math.random()*5.2}s`),e.style.animationDelay=`${Math.random()*4}s`,d.appendChild(e)}}function D(){if(!d||m.length===0)return;const t=document.createElement("img");t.className="rain-icon";const o=m[Math.floor(Math.random()*m.length)],e=Math.random()*24+16;t.src=`/icons/${o}`,t.alt="",t.loading="lazy",t.style.left=`${Math.random()*100}%`,t.style.top=`${-50-Math.random()*80}px`,t.style.width=`${e}px`,t.style.height=`${e}px`,t.style.opacity=`${.34+Math.random()*.36}`,t.style.setProperty("--icon-duration",`${6.5+Math.random()*6.5}s`),t.style.setProperty("--icon-drift",`${-55+Math.random()*110}px`),t.style.setProperty("--icon-rotate",`${80+Math.random()*170}deg`),t.style.animationDelay=`${Math.random()*.5}s`,t.onerror=()=>t.remove(),d.appendChild(t),window.setTimeout(()=>t.remove(),12e3)}function F(t,o,e){const n=()=>{t();const s=o+Math.random()*(e-o);window.setTimeout(n,s)};n()}function O(){N(),(l==="icons"||l==="mixed"||l==="stars")&&F(D,700,1700)}function I(t){return t==="admin"?"/admin/":t==="lider"||t==="gerente"?"/gerente/":t==="funcionario"?"/funcionario/":null}function u(t,o=""){y.textContent=t,y.className=`message ${o}`.trim()}async function T(t,o){const e=await fetch(`${b}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,senha:o})}),n=await e.json().catch(()=>({}));if(!e.ok)throw new Error(n.detail||"Falha ao autenticar.");return n}async function _(t){const o=await fetch(`${b}/auth/forgot-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t})}),e=await o.json().catch(()=>({}));if(!o.ok)throw new Error(e.detail||"Falha ao solicitar redefinicao.");return e}const R=v(),E=I(R);E&&window.location.replace(E);k.checked=x();O();g.addEventListener("click",()=>{const t=w.type==="password";w.type=t?"text":"password",g.setAttribute("aria-label",t?"Ocultar senha":"Mostrar senha"),g.textContent=t?"ðŸ™ˆ":"ðŸ‘"});h.addEventListener("submit",async t=>{t.preventDefault();const o=new FormData(h),e=String(o.get("email")||"").trim(),n=String(o.get("senha")||"").trim(),s=!!o.get("remember_me");u(""),i.disabled=!0,i.textContent="Entrando...";try{const r=await T(e,n);C(r.access_token,r.refresh_token,s);const $=v(),f=I($);if(!f)throw new Error("Perfil sem area configurada no frontend.");u("Login realizado com sucesso.","success"),window.location.replace(f)}catch(r){u(r.message,"error")}finally{i.disabled=!1,i.textContent="Entrar"}});function a(t,o=""){p.textContent=t,p.className=`message ${o}`.trim()}S.addEventListener("click",()=>{a(""),B.value=document.getElementById("email").value||"",M.showModal()});L.addEventListener("click",()=>{M.close()});P.addEventListener("submit",async t=>{t.preventDefault();const o=B.value.trim();if(!o){a("Informe um email valido.","error");return}c.disabled=!0,c.textContent="Enviando...",a("");try{const e=await _(o);a(e.detail||"Solicitacao enviada.","success")}catch(e){a(e.message,"error")}finally{c.disabled=!1,c.textContent="Enviar email"}});
